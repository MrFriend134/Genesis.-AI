<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <title>AI GENESIS - Command Dashboard</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="app" class="app" data-app-state="booting">
    <a class="skip-link" href="#chat">Skip to chat</a>

    <div id="bootOverlay" class="boot-overlay" aria-hidden="false">
      <div class="boot-card" role="status" aria-live="polite">
        <div class="boot-grid" aria-hidden="true"></div>
        <div class="boot-header">
          <div class="boot-logo" aria-hidden="true">
            <svg viewBox="0 0 64 64" width="40" height="40" focusable="false" aria-hidden="true">
              <path d="M32 4l24 14v28L32 60 8 46V18L32 4z" fill="none" stroke="currentColor" stroke-width="2" />
              <path d="M32 12l16 9v18l-16 9-16-9V21l16-9z" fill="none" stroke="currentColor" stroke-width="2" />
              <path d="M32 12v36" fill="none" stroke="currentColor" stroke-width="2" opacity="0.6" />
            </svg>
          </div>
          <div class="boot-title">
            <div class="boot-name">AI GENESIS</div>
            <div class="boot-sub">System Initialization</div>
          </div>
        </div>

        <div class="boot-body">
          <div class="boot-lines" aria-hidden="true">
            <div class="boot-line"><span class="k">[OK]</span> Loading core modules</div>
            <div class="boot-line"><span class="k">[OK]</span> Calibrating diagnostics</div>
            <div class="boot-line"><span class="k">[OK]</span> Preparing local storage</div>
            <div class="boot-line"><span class="k">[..]</span> Awaiting operator key</div>
          </div>

          <div class="boot-progress" aria-hidden="true">
            <div class="boot-progress-bar"></div>
          </div>

          <div class="boot-hint">
            Open <button type="button" class="linklike" id="bootOpenSettings">Settings</button> to add your Google API key.
          </div>
        </div>
      </div>
    </div>

    <header class="topbar" role="banner">
      <div class="topbar-left">
        <button id="sidebarToggle" class="icon-btn" type="button" aria-label="Toggle sidebar" aria-controls="sidebar" aria-expanded="true">
          <span class="icon" aria-hidden="true" data-icon="menu">
            <svg viewBox="0 0 24 24" width="20" height="20" focusable="false" aria-hidden="true">
              <path d="M4 7h16M4 12h16M4 17h16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </span>
        </button>

        <div class="brand" aria-label="AI GENESIS">
          <div class="brand-mark" aria-hidden="true">
            <svg viewBox="0 0 48 48" width="28" height="28" focusable="false" aria-hidden="true">
              <path d="M24 3l18 10.5v21L24 45 6 34.5v-21L24 3z" fill="none" stroke="currentColor" stroke-width="2" />
              <path d="M24 10l12 7v14l-12 7-12-7V17l12-7z" fill="none" stroke="currentColor" stroke-width="2" opacity="0.7" />
            </svg>
          </div>
          <div class="brand-text">
            <div class="brand-title">AI GENESIS</div>
            <div class="brand-sub">Gemini 1.5 Flash Console</div>
          </div>
        </div>
      </div>

      <div class="topbar-center" aria-label="System diagnostics">
        <div class="stat">
          <div class="stat-label">Status</div>
          <div class="stat-value" id="diagStatus" data-state="unknown">UNKNOWN</div>
        </div>
        <div class="stat">
          <div class="stat-label">Clock</div>
          <div class="stat-value" id="diagClock">--:--:--</div>
        </div>
        <div class="stat">
          <div class="stat-label">Memory</div>
          <div class="stat-value" id="diagMemory">0 / 15</div>
        </div>
        <div class="stat">
          <div class="stat-label">Latency</div>
          <div class="stat-value" id="diagLatency">-- ms</div>
        </div>
      </div>

      <div class="topbar-right">
        <button id="newSessionBtn" class="pill-btn" type="button">
          <span class="pill-icon" aria-hidden="true" data-icon="plus">
            <svg viewBox="0 0 24 24" width="18" height="18" focusable="false" aria-hidden="true">
              <path d="M12 5v14M5 12h14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
            </svg>
          </span>
          <span class="pill-text">New Session</span>
        </button>

        <button id="openSettingsBtn" class="icon-btn" type="button" aria-label="Open settings" aria-haspopup="dialog" aria-controls="settingsModal">
          <span class="icon" aria-hidden="true" data-icon="settings">
            <svg viewBox="0 0 24 24" width="20" height="20" focusable="false" aria-hidden="true">
              <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z" fill="none" stroke="currentColor" stroke-width="2" />
              <path d="M19.4 15a7.8 7.8 0 0 0 .1-1 7.8 7.8 0 0 0-.1-1l2-1.6-2-3.4-2.4 1a7.6 7.6 0 0 0-1.7-1l-.3-2.6H10l-.3 2.6a7.6 7.6 0 0 0-1.7 1l-2.4-1-2 3.4L5.6 13a7.8 7.8 0 0 0-.1 1 7.8 7.8 0 0 0 .1 1l-2 1.6 2 3.4 2.4-1a7.6 7.6 0 0 0 1.7 1l.3 2.6h4l.3-2.6a7.6 7.6 0 0 0 1.7-1l2.4 1 2-3.4-2-1.6z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linejoin="round" opacity="0.85" />
            </svg>
          </span>
        </button>
      </div>
    </header>

    <div class="layout">
      <aside id="sidebar" class="sidebar" aria-label="Session history">
        <div class="sidebar-header">
          <div class="sidebar-title">Session History</div>
          <div class="sidebar-actions">
            <button id="clearAllBtn" class="ghost-btn" type="button" aria-label="Clear all sessions">
              <span class="icon" aria-hidden="true" data-icon="trash">
                <svg viewBox="0 0 24 24" width="18" height="18" focusable="false" aria-hidden="true">
                  <path d="M6 7h12M10 7V5h4v2M8 7l1 14h6l1-14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                </svg>
              </span>
            </button>
          </div>
        </div>

        <div class="sidebar-search">
          <label class="field">
            <span class="field-label">Filter</span>
            <input id="sessionFilter" class="input" type="text" placeholder="Search sessions" autocomplete="off" />
          </label>
        </div>

        <nav class="session-list" id="sessionList" aria-label="Saved sessions"></nav>

        <div class="sidebar-footer">
          <div class="mini-card" role="note" aria-label="Security note">
            <div class="mini-title">Local Persistence</div>
            <div class="mini-body">Sessions and settings are stored in this browser via localStorage.</div>
          </div>
        </div>
      </aside>

      <main class="main" role="main">
        <section class="chat" id="chat" aria-label="Main chat area">
          <header class="chat-header">
            <div class="chat-meta">
              <div class="chat-title">
                <span class="chat-title-text" id="activeSessionTitle">Active Session</span>
                <span class="chip" id="activeSessionId">--</span>
              </div>
              <div class="chat-sub" id="activeSessionSub">Gemini 1.5 Flash | English-only policy | Rolling memory enabled</div>
            </div>

            <div class="chat-header-actions">
              <button class="ghost-btn" id="renameSessionBtn" type="button">
                <span class="icon" aria-hidden="true" data-icon="edit">
                  <svg viewBox="0 0 24 24" width="18" height="18" focusable="false" aria-hidden="true">
                    <path d="M4 20h4l10.5-10.5-4-4L4 16v4z" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                    <path d="M13.5 6.5l4 4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                  </svg>
                </span>
                <span>Rename</span>
              </button>
              <button class="ghost-btn" id="exportSessionBtn" type="button">
                <span class="icon" aria-hidden="true" data-icon="download">
                  <svg viewBox="0 0 24 24" width="18" height="18" focusable="false" aria-hidden="true">
                    <path d="M12 3v12" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    <path d="M7 10l5 5 5-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M5 21h14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                  </svg>
                </span>
                <span>Export</span>
              </button>
            </div>
          </header>

          <div class="chat-body" id="chatBody" aria-live="polite" aria-busy="false">
            <div class="chat-empty" id="chatEmpty">
              <div class="avatar" aria-hidden="true">
                <div class="avatar-ring"></div>
                <div class="avatar-core">
                  <svg viewBox="0 0 64 64" width="28" height="28" focusable="false" aria-hidden="true">
                    <path d="M32 6l22 13v26L32 58 10 45V19L32 6z" fill="none" stroke="currentColor" stroke-width="2" />
                    <path d="M22 28h20M22 36h14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.75" />
                  </svg>
                </div>
              </div>
              <div class="chat-empty-title">No messages yet</div>
              <div class="chat-empty-sub">Start a conversation. The assistant will respond strictly in English.</div>
            </div>

            <div class="message-list" id="messageList" aria-label="Message list"></div>

            <div class="typing" id="typingIndicator" aria-hidden="true">
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-text">AI GENESIS is thinking...</div>
            </div>
          </div>

          <footer class="composer" aria-label="Message composer">
            <form id="composerForm" class="composer-form" autocomplete="off">
              <div class="composer-left" aria-hidden="true">
                <div class="signal">
                  <div class="signal-bar"></div>
                  <div class="signal-bar"></div>
                  <div class="signal-bar"></div>
                </div>
              </div>

              <label class="composer-input-wrap">
                <span class="sr-only">Message</span>
                <textarea id="messageInput" class="composer-input" rows="1" placeholder="Send a message to AI GENESIS..." spellcheck="true"></textarea>
              </label>

              <div class="composer-actions">
                <button id="sendBtn" class="primary-btn" type="submit">
                  <span class="icon" aria-hidden="true" data-icon="send">
                    <svg viewBox="0 0 24 24" width="18" height="18" focusable="false" aria-hidden="true">
                      <path d="M3 12l18-9-6 18-2.5-6L3 12z" fill="none" stroke="currentColor" stroke-width="2" stroke-linejoin="round" />
                      <path d="M21 3L12.5 15" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                    </svg>
                  </span>
                  <span>Send</span>
                </button>
              </div>
            </form>

            <div class="composer-hints">
              <div class="hint">
                <span class="hint-kbd">Enter</span>
                <span class="hint-text">Send</span>
              </div>
              <div class="hint">
                <span class="hint-kbd">Shift</span>
                <span class="hint-kbd">Enter</span>
                <span class="hint-text">New line</span>
              </div>
              <div class="hint" id="apiKeyHint">
                <span class="hint-dot" aria-hidden="true"></span>
                <span class="hint-text">API key required</span>
              </div>
            </div>
          </footer>
        </section>
      </main>
    </div>

    <div class="modal" id="settingsModal" role="dialog" aria-modal="true" aria-hidden="true" aria-label="Settings">
      <div class="modal-backdrop" data-close="true"></div>
      <div class="modal-card" role="document">
        <header class="modal-header">
          <div class="modal-title">Settings</div>
          <button class="icon-btn" id="closeSettingsBtn" type="button" aria-label="Close settings">
            <span class="icon" aria-hidden="true" data-icon="x">
              <svg viewBox="0 0 24 24" width="20" height="20" focusable="false" aria-hidden="true">
                <path d="M6 6l12 12M18 6L6 18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
              </svg>
            </span>
          </button>
        </header>

        <div class="modal-body">
          <section class="settings-grid" aria-label="API and generation settings">
            <div class="settings-col">
              <div class="section-title">Google Gemini</div>

              <label class="field">
                <span class="field-label">Google API Key</span>
                <input id="apiKeyInput" class="input" type="password" placeholder="AIza..." autocomplete="off" />
                <span class="field-help" id="apiKeyStatus">Not set</span>
              </label>

              <div class="inline-actions">
                <button id="revealKeyBtn" class="ghost-btn" type="button">Reveal</button>
                <button id="testKeyBtn" class="ghost-btn" type="button">Test Key</button>
              </div>

              <div class="divider"></div>

              <div class="section-title">Generation Controls</div>

              <label class="field">
                <span class="field-label">AI Temperature</span>
                <div class="range-row">
                  <input id="temperatureInput" class="range" type="range" min="0" max="1" step="0.05" value="0.4" />
                  <output id="temperatureOut" class="range-out">0.40</output>
                </div>
                <span class="field-help">Lower values are more deterministic; higher values are more creative.</span>
              </label>

              <label class="field">
                <span class="field-label">Max Tokens</span>
                <div class="range-row">
                  <input id="maxTokensInput" class="range" type="range" min="64" max="2048" step="32" value="512" />
                  <output id="maxTokensOut" class="range-out">512</output>
                </div>
                <span class="field-help">Controls the maximum output length per response.</span>
              </label>
            </div>

            <div class="settings-col">
              <div class="section-title">Diagnostics</div>

              <div class="diag-grid" aria-label="Local diagnostic panel">
                <div class="diag-card">
                  <div class="diag-k">Active Model</div>
                  <div class="diag-v" id="diagModel">gemini-1.5-flash</div>
                </div>
                <div class="diag-card">
                  <div class="diag-k">Storage</div>
                  <div class="diag-v" id="diagStorage">localStorage</div>
                </div>
                <div class="diag-card">
                  <div class="diag-k">Sessions</div>
                  <div class="diag-v" id="diagSessionsCount">0</div>
                </div>
                <div class="diag-card">
                  <div class="diag-k">Last Error</div>
                  <div class="diag-v" id="diagLastError">none</div>
                </div>
              </div>

              <div class="divider"></div>

              <div class="section-title">Operator Actions</div>
              <div class="stack-actions">
                <button id="wipeApiKeyBtn" class="danger-btn" type="button">Wipe API Key</button>
                <button id="wipeSessionsBtn" class="danger-btn" type="button">Wipe All Sessions</button>
              </div>

              <div class="notice" role="note">
                <div class="notice-title">Important</div>
                <div class="notice-body">Your API key is stored locally in this browser. Use Wipe API Key if you are on a shared machine.</div>
              </div>
            </div>
          </section>
        </div>

        <footer class="modal-footer">
          <button id="saveSettingsBtn" class="primary-btn" type="button">Save Settings</button>
        </footer>
      </div>
    </div>

    <div class="toast-region" id="toastRegion" aria-live="polite" aria-label="Notifications"></div>
  </div>

  <script src="script.js"></script>
</body>
</html>
